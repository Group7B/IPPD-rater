<section ng-controller="RatingsController" ng-init="find()">
  <div class="page-header">
    <h1>Project Ranking</h1>
   <label>Search Project: <input ng-model="searchText"></label>
  <input type="submit">
  </div>
  <div class="list-group">
    <button class="btn btn-primary btn-sm" ng-click="sortType = 'posterRating'; sortType2 = '-posterRank'"> Poster </button>
    <button class="btn btn-primary btn-sm" ng-click="sortType = 'presentationRating'; sortType2 = '-presentationRank'"> Presentation </button>
    <button class="btn btn-primary btn-sm" ng-click="sortType = 'demoRating'; sortType2 = '-demoRank'"> Demo </button>
    <div ng-repeat="rating in ratings | filter: {$: authentication.user._id} : true | orderBy:[sortType,sortType2]:sortReverse" class="list-group-item" >
      <div class="row">

        <div class="clearfix visible-xs-block"></div>
        <div class="col-xs-4 col-sm-2">
          <div class="post-thumb"><img class="logo-icon" ng-if="rating.project.logo" ng-src='modules/projects/client/img/logos/{{rating.project.logo}}' alt="No img"></div>
          <div class="post-thumb"><img class="logo-icon" ng-if="!rating.project.logo" src='modules/projects/client/img/logos/default.jpg' alt="No img"></div>
        </div>

        <div class="col-xs-5 col-sm-8">
          <p  class="list-group-item-heading" ng-bind="rating.project.teamName"></p>
        </div>

        <div class="col-xs-3 col-sm-2">

          <div ng-show="sortType === 'posterRating'">
            <text>Rank:</text>
            <select ng-model="rating.posterRank" ng-change="updateRank(rating)" ng-options="n for n in rankRange(1,ratings.length)">
            </select>
          </div>

          <div ng-show="sortType === 'presentationRating'">
            <text>Rank:</text>
            <select ng-model="rating.presentationRank" ng-change="updateRank(rating)" ng-options="n for n in rankRange(1,ratings.length)">
            </select>
          </div>

          <div ng-show="sortType === 'demoRating'">
            <text>Rank:</text>
            <select ng-model="rating.demoRank" ng-change="updateRank(rating)" ng-options="n for n in rankRange(1,ratings.length)">
            </select>
          </div>

        </div>

        <div class="col-xs-10">
          <div class="list-group-item-text" ng-bind="rating.project.description"></div>
        </div>

          <div class="col-xs-10">

            <div class="list-group-item" ng-show="sortType === 'posterRating'">
                <text>Poster Rating: </text>
                <text class="list-group-item-text" ng-bind="getStars(rating.posterRating)"></text>
            </div>
            <div class="list-group-item" ng-show="sortType === 'presentationRating'">
                <text>Presentation Rating: </text>
                <text class="list-group-item-text" ng-bind="getStars(rating.presentationRating)"></text>
            </div>
            <div class="list-group-item" ng-show="sortType === 'demoRating'">
                <text>Demo Rating: </text>
                <text class="list-group-item-text" ng-bind="getStars(rating.demoRating)"></text>
            </div>
            <div class="list-group-item">
                <text>My Comment: </text>
                <text class="list-group-item-text" ng-bind="rating.comment"></text>
            </div>
          </div>


      </div>
      <button ui-sref="projects.rate({projectId: rating.project._id})" class="btn btn-md"> Change Ratings</button>
    </div>

    <div class="form-group">
      <button ui-sref="projects.list()" class="btn btn-primary btn-lg btn-block"> Go to Projects </button>
    </div>

  </div>
  <div class="alert alert-warning text-center" ng-if="projects.$resolved && !projects.length">
    No projects yet, why don't you <a ui-sref="projects.create">create one</a>?
  </div>
</section>
